<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1312.5px" preserveAspectRatio="none" style="width:632px;height:1312px;background:#FFFFFF;" version="1.1" viewBox="0 0 632 1312" width="632.2917px" zoomAndPan="magnify"><defs><linearGradient id="g31kne3m4ygio0" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#59B6EC"/><stop offset="100%" stop-color="#2FA4E7"/></linearGradient><linearGradient id="g31kne3m4ygio1" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#35638F"/><stop offset="100%" stop-color="#033C73"/></linearGradient><linearGradient id="g31kne3m4ygio2" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#F8F9FA"/></linearGradient></defs><g><g><title>Dapp</title><rect fill="#EDF0F2" height="521.4844" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="99.9105" y="61.4258"/></g><g><title>Dapp</title><rect fill="#EDF0F2" height="205.0781" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="99.9105" y="728.6458"/></g><g><title>Wallet</title><rect fill="#EDF0F2" height="636.0352" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="362.4044" y="368.4896"/></g><g><title>Wallet</title><rect fill="#EDF0F2" height="244.6289" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="367.6127" y="582.9102"/></g><g><title>Dapp</title><rect fill="#000000" fill-opacity="0.00000" height="962.8906" width="8.3333" x="100.9521" y="51.0091"/><line style="stroke:#BABDBF;stroke-width:1.0417;stroke-dasharray:5.0,5.0;" x1="104.1667" x2="104.1667" y1="51.0091" y2="1013.8997"/></g><g><title>Wallet</title><rect fill="#000000" fill-opacity="0.00000" height="962.8906" width="8.3333" x="363.446" y="51.0091"/><line style="stroke:#BABDBF;stroke-width:1.0417;stroke-dasharray:5.0,5.0;" x1="366.5843" x2="366.5843" y1="51.0091" y2="1013.8997"/></g><g class="participant participant-head" data-participant="Dapp"><rect fill="url(#g31kne3m4ygio0)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0417;" width="58.1543" x="76.0417" y="10.4167"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="33.1543" x="88.5417" y="34.5194">Dapp</text></g><g class="participant participant-head" data-participant="Wallet"><rect fill="url(#g31kne3m4ygio0)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0417;" width="64.5569" x="335.3343" y="10.4167"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="39.5569" x="347.8343" y="34.5194">Wallet</text></g><g><title>Dapp</title><rect fill="#EDF0F2" height="521.4844" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="99.9105" y="61.4258"/></g><g><title>Dapp</title><rect fill="#EDF0F2" height="205.0781" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="99.9105" y="728.6458"/></g><g><title>Wallet</title><rect fill="#EDF0F2" height="636.0352" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="362.4044" y="368.4896"/></g><g><title>Wallet</title><rect fill="#EDF0F2" height="244.6289" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="367.6127" y="582.9102"/></g><path d="M15.625,70.8008 L15.625,96.8424 A4.1667,4.1667 0 0 0 19.7917,101.0091 L454.1667,101.0091 A4.1667,4.1667 0 0 0 458.3333,96.8424 L458.3333,77.0508 L447.9167,66.6341 L19.7917,66.6341 A4.1667,4.1667 0 0 0 15.625,70.8008" fill="url(#g31kne3m4ygio1)" style="stroke:#033C73;stroke-width:1.0417;"/><path d="M447.9167,66.6341 L447.9167,74.9674 A2.0833,2.0833 0 0 0 450,77.0508 L458.3333,77.0508 L447.9167,66.6341" fill="url(#g31kne3m4ygio1)" style="stroke:#033C73;stroke-width:1.0417;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="410.73" x="27.0833" y="88.6536">User initiates a wallet request (e.g. transaction signing) in a dapp</text><rect fill="url(#g31kne3m4ygio2)" height="3.125" rx="4.1667" ry="4.1667" style="stroke:url(#g31kne3m4ygio2);stroke-width:1.0417;" width="610.2722" x="10.4167" y="140.5273"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="620.6889" y1="140.5273" y2="140.5273"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="620.6889" y1="143.6523" y2="143.6523"/><rect fill="url(#g31kne3m4ygio2)" height="47.8516" rx="4.1667" ry="4.1667" style="stroke:#868E96;stroke-width:2.0833;" width="367.4011" x="131.8522" y="117.6432"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="334.8206" x="143.3105" y="138.621">Establish association between Dapp and Wallet</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="338.0493" x="143.3105" y="153.1718">This could be via Android Intent, QR code, etc...</text><g class="message" data-participant-1="Dapp" data-participant-2="Dapp"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="110.3271" x2="154.0771" y1="207.1289" y2="207.1289"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="154.0771" x2="154.0771" y1="207.1289" y2="220.6706"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="111.3688" x2="154.0771" y1="220.6706" y2="220.6706"/><polygon fill="#2FA4E7" points="121.7855,216.5039,111.3688,220.6706,121.7855,224.8372,117.6188,220.6706" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="140.3687" x="122.8271" y="196.8892">generate ECDSA pair (</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="21.8445" x="263.1958" y="196.8892">d_a</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="285.0403" y="196.8892">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="23.7488" x="292.9871" y="196.8892">Q_a</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="316.7358" y="196.8892">)</text></g><g class="message" data-participant-1="Dapp" data-participant-2="Wallet"><polygon fill="#2FA4E7" points="355.1127,256.0547,365.5294,260.2214,355.1127,264.388,359.2794,260.2214" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="110.3271" x2="361.3627" y1="260.2214" y2="260.2214"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="7.9529" x="122.8271" y="249.9817">{</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="23.7488" x="130.78" y="249.9817">Q_a</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="7.9529" x="154.5288" y="249.9817">}</text></g><g class="message" data-participant-1="Dapp" data-participant-2="Wallet"><line style="stroke:#2FA4E7;stroke-width:2.0833;" x1="348.8627" x2="359.2794" y1="294.5638" y2="304.9805"/><line style="stroke:#2FA4E7;stroke-width:2.0833;" x1="348.8627" x2="359.2794" y1="304.9805" y2="294.5638"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="110.3271" x2="354.071" y1="299.7721" y2="299.7721"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="221.8689" x="122.8271" y="289.5325">poll for WebSocket server available</text></g><g class="message" data-participant-1="Dapp" data-participant-2="Wallet"><line style="stroke:#2FA4E7;stroke-width:2.0833;" x1="348.8627" x2="359.2794" y1="309.1471" y2="319.5638"/><line style="stroke:#2FA4E7;stroke-width:2.0833;" x1="348.8627" x2="359.2794" y1="319.5638" y2="309.1471"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="110.3271" x2="354.071" y1="314.3555" y2="314.3555"/></g><g class="message" data-participant-1="Dapp" data-participant-2="Wallet"><line style="stroke:#2FA4E7;stroke-width:2.0833;" x1="348.8627" x2="359.2794" y1="323.7305" y2="334.1471"/><line style="stroke:#2FA4E7;stroke-width:2.0833;" x1="348.8627" x2="359.2794" y1="334.1471" y2="323.7305"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="110.3271" x2="354.071" y1="328.9388" y2="328.9388"/></g><g class="message" data-participant-1="Dapp" data-participant-2="Wallet"><polygon fill="#2FA4E7" points="349.9044,364.3229,360.321,368.4896,349.9044,372.6563,354.071,368.4896" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="110.3271" x2="356.1544" y1="368.4896" y2="368.4896"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="49.8291" x="122.8271" y="358.2499">connect</text></g><rect fill="url(#g31kne3m4ygio2)" height="3.125" rx="4.1667" ry="4.1667" style="stroke:url(#g31kne3m4ygio2);stroke-width:1.0417;" width="610.2722" x="10.4167" y="410.1237"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="620.6889" y1="410.1237" y2="410.1237"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="620.6889" y1="413.2487" y2="413.2487"/><rect fill="url(#g31kne3m4ygio2)" height="47.8516" rx="4.1667" ry="4.1667" style="stroke:#868E96;stroke-width:2.0833;" width="349.4263" x="140.8396" y="387.2396"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="246.7224" x="152.298" y="408.2174">WebSocket connection established</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="320.0745" x="152.298" y="422.7681">Perform ECDH to obtain a unique session key</text><g class="message" data-participant-1="Dapp" data-participant-2="Dapp"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="110.3271" x2="154.0771" y1="476.7253" y2="476.7253"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="154.0771" x2="154.0771" y1="476.7253" y2="490.2669"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="111.3688" x2="154.0771" y1="490.2669" y2="490.2669"/><polygon fill="#2FA4E7" points="121.7855,486.1003,111.3688,490.2669,121.7855,494.4336,117.6188,490.2669" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="133.2825" x="122.8271" y="466.4856">generate ECDH pair (</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="22.1191" x="256.1096" y="466.4856">d_d</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="278.2288" y="466.4856">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="24.0234" x="286.1755" y="466.4856">Q_d</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="310.199" y="466.4856">)</text></g><g class="message" data-participant-1="Dapp" data-participant-2="Dapp"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="110.3271" x2="154.0771" y1="529.8177" y2="529.8177"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="154.0771" x2="154.0771" y1="529.8177" y2="543.3594"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="111.3688" x2="154.0771" y1="543.3594" y2="543.3594"/><polygon fill="#2FA4E7" points="121.7855,539.1927,111.3688,543.3594,121.7855,547.526,117.6188,543.3594" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="118.2312" x="122.8271" y="519.578">S_a = ECDSA-sign(</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="21.8445" x="241.0583" y="519.578">d_a</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="262.9028" y="519.578">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="24.0234" x="270.8496" y="519.578">Q_d</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="294.873" y="519.578">)</text></g><g class="message" data-participant-1="Dapp" data-participant-2="Wallet"><polygon fill="#2FA4E7" points="355.1127,578.7435,365.5294,582.9102,355.1127,587.0768,359.2794,582.9102" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="105.1188" x2="361.3627" y1="582.9102" y2="582.9102"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="85.6628" x="117.6188" y="572.6705">HELLO_REQ {</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="24.0234" x="203.2817" y="572.6705">Q_d</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.4229" x="231.2785" y="572.6705">||</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="21.8445" x="243.6747" y="572.6705">S_a</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="7.9529" x="265.5192" y="572.6705">}</text></g><g class="message" data-participant-1="Wallet" data-participant-2="Wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="378.0294" x2="421.7794" y1="622.4609" y2="622.4609"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="421.7794" x2="421.7794" y1="622.4609" y2="636.0026"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="379.071" x2="421.7794" y1="636.0026" y2="636.0026"/><polygon fill="#2FA4E7" points="389.4877,631.8359,379.071,636.0026,389.4877,640.1693,385.321,636.0026" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="35.498" x="390.5294" y="612.2213">verify</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="21.8445" x="430.0008" y="612.2213">S_a</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="26.5198" x="455.8187" y="612.2213">with</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="23.7488" x="486.3118" y="612.2213">Q_a</text></g><g class="message" data-participant-1="Wallet" data-participant-2="Wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="378.0294" x2="421.7794" y1="675.5534" y2="675.5534"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="421.7794" x2="421.7794" y1="675.5534" y2="689.0951"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="379.071" x2="421.7794" y1="689.0951" y2="689.0951"/><polygon fill="#2FA4E7" points="389.4877,684.9284,379.071,689.0951,389.4877,693.2617,385.321,689.0951" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="133.2825" x="390.5294" y="665.3137">generate ECDH pair (</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="24.408" x="523.8118" y="665.3137">d_w</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="548.2198" y="665.3137">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="26.3123" x="556.1666" y="665.3137">Q_w</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="582.4788" y="665.3137">)</text></g><g class="message" data-participant-1="Wallet" data-participant-2="Dapp"><polygon fill="#2FA4E7" points="121.7855,724.4792,111.3688,728.6458,121.7855,732.8125,117.6188,728.6458" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="115.5355" x2="366.571" y1="728.6458" y2="728.6458"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="83.3984" x="133.2438" y="718.4062">HELLO_RSP {</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="26.3123" x="216.6423" y="718.4062">Q_w</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="7.9529" x="242.9545" y="718.4062">}</text></g><g class="message" data-participant-1="Wallet" data-participant-2="Wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="378.0294" x2="421.7794" y1="768.1966" y2="768.1966"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="421.7794" x2="421.7794" y1="768.1966" y2="781.7383"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="379.071" x2="421.7794" y1="781.7383" y2="781.7383"/><polygon fill="#2FA4E7" points="389.4877,777.5716,379.071,781.7383,389.4877,785.9049,385.321,781.7383" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="8.5632" x="390.5294" y="757.9569">Z</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="54.9744" x="403.066" y="757.9569">= ECDH(</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="24.408" x="458.0404" y="757.9569">d_w</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="482.4483" y="757.9569">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="24.0234" x="490.3951" y="757.9569">Q_d</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="514.4185" y="757.9569">)</text></g><g class="message" data-participant-1="Wallet" data-participant-2="Wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="378.0294" x2="421.7794" y1="826.4974" y2="826.4974"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="421.7794" x2="421.7794" y1="826.4974" y2="840.0391"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="372.821" x2="421.7794" y1="840.0391" y2="840.0391"/><polygon fill="#2FA4E7" points="383.2377,835.8724,372.821,840.0391,383.2377,844.2057,379.071,840.0391" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="8.197" x="390.5294" y="816.2577">K</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="53.7354" x="402.6998" y="816.2577">= HKDF(</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="8.5632" x="456.4351" y="816.2577">Z</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="464.9984" y="816.2577">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="23.7488" x="472.9451" y="816.2577">Q_a</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="28.7292" x="496.6939" y="816.2577">, 16)</text></g><g class="message" data-participant-1="Dapp" data-participant-2="Dapp"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="110.3271" x2="154.0771" y1="874.3815" y2="874.3815"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="154.0771" x2="154.0771" y1="874.3815" y2="887.9232"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="111.3688" x2="154.0771" y1="887.9232" y2="887.9232"/><polygon fill="#2FA4E7" points="121.7855,883.7565,111.3688,887.9232,121.7855,892.0898,117.6188,887.9232" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="8.5632" x="122.8271" y="864.1418">Z</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="54.9744" x="135.3638" y="864.1418">= ECDH(</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="22.1191" x="190.3381" y="864.1418">d_d</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="212.4573" y="864.1418">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="26.3123" x="220.4041" y="864.1418">Q_w</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="246.7163" y="864.1418">)</text></g><g class="message" data-participant-1="Dapp" data-participant-2="Dapp"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="110.3271" x2="154.0771" y1="932.6823" y2="932.6823"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="154.0771" x2="154.0771" y1="932.6823" y2="946.224"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="105.1188" x2="154.0771" y1="946.224" y2="946.224"/><polygon fill="#2FA4E7" points="115.5355,942.0573,105.1188,946.224,115.5355,950.3906,111.3688,946.224" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="8.197" x="122.8271" y="922.4426">K</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="53.7354" x="134.9976" y="922.4426">= HKDF(</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="8.5632" x="188.7329" y="922.4426">Z</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="197.2961" y="922.4426">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="23.7488" x="205.2429" y="922.4426">Q_a</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="28.7292" x="228.9917" y="922.4426">, 16)</text></g><rect fill="url(#g31kne3m4ygio2)" height="3.125" rx="4.1667" ry="4.1667" style="stroke:url(#g31kne3m4ygio2);stroke-width:1.0417;" width="610.2722" x="10.4167" y="975.3743"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="620.6889" y1="975.3743" y2="975.3743"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="620.6889" y1="978.4993" y2="978.4993"/><rect fill="url(#g31kne3m4ygio2)" height="33.3008" rx="4.1667" ry="4.1667" style="stroke:#868E96;stroke-width:2.0833;" width="443.75" x="93.6778" y="959.7656"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="414.3982" x="105.1361" y="980.7434">cryptochannel ready for encrypted session communication</text><rect fill="none" height="273.6165" rx="4.1667" ry="4.1667" style="stroke:#BABDBF;stroke-width:1.0417;" width="478.0599" x="76.002" y="1014.9414"/><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="92.6687" y="1047.228">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" font-style="italic" lengthAdjust="spacing" textLength="25.4852" x="97.3043" y="1047.228">d_a</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="122.7895" y="1047.228">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="303.8788" x="147.6898" y="1047.228">Dapp association ECDSA private keypoint</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="92.6687" y="1074.6206">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" font-style="italic" lengthAdjust="spacing" textLength="27.7069" x="97.3043" y="1074.6206">Q_a</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="125.0112" y="1074.6206">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="296.1955" x="147.6898" y="1074.6206">Dapp association ECDSA public keypoint</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="92.6687" y="1102.0131">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" font-style="italic" lengthAdjust="spacing" textLength="25.8057" x="97.3043" y="1102.0131">d_d</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="123.1099" y="1102.0131">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="375.7985" x="147.6898" y="1102.0131">Dapp session establishment ECDH private keypoint</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="92.6687" y="1129.4057">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" font-style="italic" lengthAdjust="spacing" textLength="28.0273" x="97.3043" y="1129.4057">Q_d</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="125.3316" y="1129.4057">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="368.1152" x="147.6898" y="1129.4057">Dapp session establishment ECDH public keypoint</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="92.6687" y="1156.7983">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" font-style="italic" lengthAdjust="spacing" textLength="25.4852" x="97.3043" y="1156.7983">S_a</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="122.7895" y="1156.7983">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="283.8765" x="147.6898" y="1156.7983">Dapp ECDSA signature of Q_d with d_a</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="92.6687" y="1184.1909">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" font-style="italic" lengthAdjust="spacing" textLength="28.476" x="97.3043" y="1184.1909">d_w</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="125.7802" y="1184.1909">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="383.2682" x="147.6898" y="1184.1909">Wallet session establishment ECDH private keypoint</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="92.6687" y="1211.5835">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" font-style="italic" lengthAdjust="spacing" textLength="30.6976" x="97.3043" y="1211.5835">Q_w</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="128.0019" y="1211.5835">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="375.5849" x="147.6898" y="1211.5835">Wallet session establishment ECDH public keypoint</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="92.6687" y="1238.976">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" font-style="italic" lengthAdjust="spacing" textLength="9.9904" x="97.3043" y="1238.976">Z</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="13.9069" x="107.2947" y="1238.976">&#160;&#160;&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="314.6169" x="147.6898" y="1238.976">Shared session establishment ECDH secret</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="4.6356" x="92.6687" y="1266.3686">&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" font-style="italic" lengthAdjust="spacing" textLength="9.5632" x="97.3043" y="1266.3686">K</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="13.9069" x="106.8675" y="1266.3686">&#160;&#160;&#160;</text><text fill="#343A40" font-family="Verdana" font-size="14.5833" lengthAdjust="spacing" textLength="365.2527" x="147.6898" y="1266.3686">Shared session establishment AES-128 secret key</text><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="542.6036" y1="1028.4831" y2="1028.4831"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="542.6036" y1="1055.8757" y2="1055.8757"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="542.6036" y1="1083.2682" y2="1083.2682"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="542.6036" y1="1110.6608" y2="1110.6608"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="542.6036" y1="1138.0534" y2="1138.0534"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="542.6036" y1="1165.446" y2="1165.446"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="542.6036" y1="1192.8385" y2="1192.8385"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="542.6036" y1="1220.2311" y2="1220.2311"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="542.6036" y1="1247.6237" y2="1247.6237"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="542.6036" y1="1275.0163" y2="1275.0163"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="87.4603" x2="87.4603" y1="1028.4831" y2="1275.0163"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="137.8459" x2="137.8459" y1="1028.4831" y2="1275.0163"/><line style="stroke:#343A40;stroke-width:1.0417;" x1="542.6036" x2="542.6036" y1="1028.4831" y2="1275.0163"/><!--SRC=[bLJHQjim57ttLzonbvOc6Tt36AKfX3ObeuKrzKR7A1H5ker57CcJv7XXsR_lMfOTBqvfwYVRL-VSSu-EzCubk4JWQF8KcOhiGggC6RQ46UEBkT6v4fSwrGRUN_idYX8f49wrTZFzEugKTWYC6sqjdC5tYmQaaauoXnOO52nDqO71NpbQ1qSuc0_06QOiuqvg1LREbLJpOqBHSi6oB8hAqee8uCf_3eSmjexDKcaJODPgJkmbTeQkG5H-6J0buC5tUrJV4cc1wpmLj0PMai582QEbW2_AeN8zcDvJNM0FqF71O033OHHvclv5HNS6SrHeIXNZowju11cJ1exEvOLuOkSVv4KFw7rQlH_NO49N6WZ_Prl_szH_REkPJbFoqS03pcBD5_IJt5kHWMp5P4hpuYxgfU-cwya94NEj57BdZTjoXx-bRrYxYU9HtQ4X4SjooWau3NhccD-BN4dQDD9aRGbQuFerboPjaqJB956Pj0EDdnWCAtVxPGowvkxWmf3zlXzpChwz_VfqFvu6f_rYs6nAQDpuNcDQ6qCMo-TrQnaKqYMjxTm7Ud7EegMtgFHkuLvvMsry5zGMB-kZ-aylovipwROHkstQq9i0dTnSNH_LLEsmzk3qqnRSx-petlQYEsKNTc3h45gVJsxMcTCyOHJEbAu99jR-JA3o5HHD_hXUBYcIl3hwPH9Jf4qHaT_ma1lOXCkWTKk4uskgAuLYd6cf7BIUJSKnVPKZfrF3zrBK7AAEOSLHYszEt99kdn2Xhg16ny4SNK618_v_baf_USYOoms2VWRgKkMUh0FOFqiHE49OtZ9DCyiRE7Qd2HnL6kaJueIPLYJsS5Za1brtbfl3E4RZk7_wyNDDKzvvdeDo1Y5k_m00]--></g></svg>