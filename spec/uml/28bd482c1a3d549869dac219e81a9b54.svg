<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2565.625px" preserveAspectRatio="none" style="width:1540px;height:2565px;background:#FFFFFF;" version="1.1" viewBox="0 0 1540 2565" width="1540.625px" zoomAndPan="magnify"><defs><linearGradient id="g1idpeqam3785x0" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#59B6EC"/><stop offset="100%" stop-color="#2FA4E7"/></linearGradient><linearGradient id="g1idpeqam3785x1" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#F8F9FA"/></linearGradient><linearGradient id="g1idpeqam3785x2" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#35638F"/><stop offset="100%" stop-color="#033C73"/></linearGradient></defs><g><rect fill="#90EE90" height="2535.5143" rx="4.1667" ry="4.1667" style="stroke:#868E96;stroke-width:1.0417;" width="183.726" x="53.125" y="11.4583"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="136.322" x="76.827" y="28.2694">Native Android app</text><rect fill="#ADD8E6" height="2535.5143" rx="4.1667" ry="4.1667" style="stroke:#868E96;stroke-width:1.0417;" width="1026.1525" x="459.4869" y="11.4583"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="114.1846" x="915.4709" y="28.2694">Android Chrome</text><g><title>Wallet app</title><rect fill="#EDF0F2" height="31.25" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="139.7797" y="191.5039"/></g><g><title>Wallet app</title><rect fill="#EDF0F2" height="1263.6068" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="139.7797" y="308.1055"/></g><g><title>Wallet app</title><rect fill="#EDF0F2" height="334.1146" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="139.7797" y="2200.3581"/></g><g><title>Web dapp</title><rect fill="#EDF0F2" height="2437.6953" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="544.3227" y="106.1523"/></g><g><title>Chrome Custom Tab</title><rect fill="#EDF0F2" height="756.7383" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="771.6807" y="646.3542"/></g><g><title>Wallet-hosted web</title><rect fill="#EDF0F2" height="516.3086" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="1063.8133" y="886.7839"/></g><g><title>Wallet-hosted web</title><rect fill="#EDF0F2" height="480.8594" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="1063.8133" y="1679.9479"/></g><g><title>Wallet-hosted Digital</title><rect fill="#EDF0F2" height="14.5833" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="1356.5033" y="725.4557"/></g><rect fill="none" height="965.918" rx="4.1667" ry="4.1667" style="stroke:#59B6EC;stroke-width:1.0417;" width="1445.0144" x="46.875" y="445.5078"/><g><title>Wallet app</title><rect fill="#000000" fill-opacity="0.00000" height="2457.487" width="8.3333" x="140.8213" y="95.7357"/><line style="stroke:#BABDBF;stroke-width:1.0417;stroke-dasharray:5.0,5.0;" x1="144.7917" x2="144.7917" y1="95.7357" y2="2553.2227"/></g><g><title>Web dapp</title><rect fill="#000000" fill-opacity="0.00000" height="2457.487" width="8.3333" x="545.3644" y="95.7357"/><line style="stroke:#BABDBF;stroke-width:1.0417;stroke-dasharray:5.0,5.0;" x1="549.0702" x2="549.0702" y1="95.7357" y2="2553.2227"/></g><g><title>Chrome Custom Tab</title><rect fill="#000000" fill-opacity="0.00000" height="2457.487" width="8.3333" x="772.7224" y="95.7357"/><line style="stroke:#BABDBF;stroke-width:1.0417;stroke-dasharray:5.0,5.0;" x1="776.2461" x2="776.2461" y1="95.7357" y2="2553.2227"/></g><g><title>Wallet-hosted web</title><rect fill="#000000" fill-opacity="0.00000" height="2457.487" width="8.3333" x="1064.8549" y="95.7357"/><line style="stroke:#BABDBF;stroke-width:1.0417;stroke-dasharray:5.0,5.0;" x1="1068.6686" x2="1068.6686" y1="95.7357" y2="2553.2227"/></g><g><title>Wallet-hosted Digital</title><rect fill="#000000" fill-opacity="0.00000" height="2457.487" width="8.3333" x="1357.545" y="95.7357"/><line style="stroke:#BABDBF;stroke-width:1.0417;stroke-dasharray:5.0,5.0;" x1="1360.7005" x2="1360.7005" y1="95.7357" y2="2553.2227"/></g><g class="participant participant-head" data-participant="wallet"><rect fill="url(#g1idpeqam3785x0)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0417;" width="92.0593" x="98.9583" y="55.1432"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="67.0593" x="111.4583" y="79.246">Wallet app</text></g><g class="participant participant-head" data-participant="dapp"><rect fill="url(#g1idpeqam3785x0)" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0417;" width="88.4216" x="505.3202" y="55.1432"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="63.4216" x="517.8202" y="79.246">Web dapp</text></g><g class="participant participant-head" data-participant="cct"><rect fill="url(#g1idpeqam3785x0)" height="54.1016" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0417;" width="153.3691" x="700.2045" y="40.5924"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="128.3691" x="712.7045" y="64.6952">Chrome Custom Tab</text><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="44.7754" x="754.5013" y="79.246">service</text></g><g class="participant participant-head" data-participant="attest"><rect fill="url(#g1idpeqam3785x0)" height="54.1016" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0417;" width="171.5393" x="983.252" y="40.5924"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="116.4978" x="1010.7727" y="64.6952">Wallet-hosted web</text><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="146.5393" x="995.752" y="79.246">origin attestation script</text></g><g class="participant participant-head" data-participant="dal"><rect fill="url(#g1idpeqam3785x0)" height="54.1016" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0417;" width="156.189" x="1283.6171" y="40.5924"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="131.189" x="1296.1171" y="64.6952">Wallet-hosted Digital</text><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="63.739" x="1329.8421" y="79.246">Asset Link</text></g><g><title>Wallet app</title><rect fill="#EDF0F2" height="31.25" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="139.7797" y="191.5039"/></g><g><title>Wallet app</title><rect fill="#EDF0F2" height="1263.6068" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="139.7797" y="308.1055"/></g><g><title>Wallet app</title><rect fill="#EDF0F2" height="334.1146" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="139.7797" y="2200.3581"/></g><g><title>Web dapp</title><rect fill="#EDF0F2" height="2437.6953" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="544.3227" y="106.1523"/></g><g><title>Chrome Custom Tab</title><rect fill="#EDF0F2" height="756.7383" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="771.6807" y="646.3542"/></g><g><title>Wallet-hosted web</title><rect fill="#EDF0F2" height="516.3086" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="1063.8133" y="886.7839"/></g><g><title>Wallet-hosted web</title><rect fill="#EDF0F2" height="480.8594" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="1063.8133" y="1679.9479"/></g><g><title>Wallet-hosted Digital</title><rect fill="#EDF0F2" height="14.5833" style="stroke:#BABDBF;stroke-width:1.0417;" width="10.4167" x="1356.5033" y="725.4557"/></g><rect fill="url(#g1idpeqam3785x1)" height="3.125" rx="4.1667" ry="4.1667" style="stroke:url(#g1idpeqam3785x1);stroke-width:1.0417;" width="1517.9311" x="10.4167" y="132.1777"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="1528.3478" y1="132.1777" y2="132.1777"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="1528.3478" y1="135.3027" y2="135.3027"/><rect fill="url(#g1idpeqam3785x1)" height="33.3008" rx="4.1667" ry="4.1667" style="stroke:#868E96;stroke-width:2.0833;" width="401.1841" x="568.7902" y="116.569"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="371.8323" x="580.2485" y="137.5468">Dapp attempts to authorize with unattested identity</text><g class="message" data-participant-1="dapp" data-participant-2="wallet"><polygon fill="#2FA4E7" points="161.6547,187.3372,151.238,191.5039,161.6547,195.6706,157.488,191.5039" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="155.4047" x2="543.281" y1="191.5039" y2="191.5039"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="195.1599" x="173.113" y="181.2642">Associate (via Local URI Intent)</text></g><path d="M60.4167,240.4622 L60.4167,266.5039 A4.1667,4.1667 0 0 0 64.5833,270.6706 L628.125,270.6706 A4.1667,4.1667 0 0 0 632.2917,266.5039 L632.2917,246.7122 L621.875,236.2956 L64.5833,236.2956 A4.1667,4.1667 0 0 0 60.4167,240.4622" fill="url(#g1idpeqam3785x2)" style="stroke:#033C73;stroke-width:1.0417;"/><path d="M621.875,236.2956 L621.875,244.6289 A2.0833,2.0833 0 0 0 623.9583,246.7122 L632.2917,246.7122 L621.875,236.2956" fill="url(#g1idpeqam3785x2)" style="stroke:#033C73;stroke-width:1.0417;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="284.3018" x="200.0326" y="258.315">Starts after Session Establishment completes</text><g class="message" data-participant-1="dapp" data-participant-2="wallet"><polygon fill="#2FA4E7" points="161.6547,303.9388,151.238,308.1055,161.6547,312.2721,157.488,308.1055" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="155.4047" x2="543.281" y1="308.1055" y2="308.1055"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="90.7166" x="173.113" y="297.8658">authorize {...}</text></g><rect fill="url(#g1idpeqam3785x1)" height="3.125" rx="4.1667" ry="4.1667" style="stroke:url(#g1idpeqam3785x1);stroke-width:1.0417;" width="1517.9311" x="10.4167" y="342.4642"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="1528.3478" y1="342.4642" y2="342.4642"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="1528.3478" y1="345.5892" y2="345.5892"/><rect fill="url(#g1idpeqam3785x1)" height="33.3008" rx="4.1667" ry="4.1667" style="stroke:#868E96;stroke-width:2.0833;" width="387.8845" x="575.44" y="326.8555"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="358.5327" x="586.8983" y="347.8333">Bind Wallet to browser with an attestation keypair</text><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="416.3411" y2="416.3411"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="416.3411" y2="429.8828"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="151.238" x2="193.9463" y1="429.8828" y2="429.8828"/><polygon fill="#2FA4E7" points="161.6547,425.7161,151.238,429.8828,161.6547,434.0495,157.488,429.8828" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="162.6963" y="391.5507">b</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="167.8162" x="174.6043" y="391.5507">= Local URI Intent browser</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="113.0615" x="162.6963" y="406.1015">package identifier</text></g><path d="M51.0417,445.5078 L122.8617,445.5078 L122.8617,462.1419 L112.4451,472.5586 L46.875,472.5586 L46.875,449.6745 A4.1667,4.1667 0 0 1 51.0417,445.5078" fill="#E9ECEF" style="stroke:#868E96;stroke-width:1.0417;"/><rect fill="none" height="965.918" rx="4.1667" ry="4.1667" style="stroke:#59B6EC;stroke-width:1.0417;" width="1445.0144" x="46.875" y="445.5078"/><text fill="#033C73" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="18.6951" x="67.7083" y="463.3606">alt</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="243.7744" x="143.6951" y="464.4023">[Wallet has a stored public key for</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="8.9478" x="391.8213" y="464.4023">b</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.7129" x="400.769" y="464.4023">]</text><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="513.1185" y2="513.1185"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="513.1185" y2="526.6602"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="151.238" x2="193.9463" y1="526.6602" y2="526.6602"/><polygon fill="#2FA4E7" points="161.6547,522.4935,151.238,526.6602,161.6547,530.8268,157.488,526.6602" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="107.373" x="162.6963" y="502.8788">read stored key (</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="11.4075" x="270.0694" y="502.8788">id</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="281.4768" y="502.8788">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="9.8389" x="289.4236" y="502.8788">Q</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="26.0376" x="299.2625" y="502.8788">) for</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="329.2735" y="502.8788">b</text></g><line style="stroke:#59B6EC;stroke-width:1.0417;stroke-dasharray:2.0,2.0;" x1="46.875" x2="1491.8894" y1="536.0352" y2="536.0352"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="318.5791" x="57.2917" y="552.8463">[Wallet does not have a stored public key for</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="8.9478" x="380.2226" y="552.8463">b</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="5.7129" x="389.1703" y="552.8463">]</text><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="593.2617" y2="593.2617"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="593.2617" y2="606.8034"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="163.738" x2="193.9463" y1="606.8034" y2="606.8034"/><line style="stroke:#2FA4E7;stroke-width:2.0833;" x1="156.4463" x2="166.863" y1="601.5951" y2="612.0117"/><line style="stroke:#2FA4E7;stroke-width:2.0833;" x1="156.4463" x2="166.863" y1="612.0117" y2="601.5951"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="107.373" x="162.6963" y="583.0221">read stored key (</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="11.4075" x="270.0694" y="583.0221">id</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="281.4768" y="583.0221">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="9.8389" x="289.4236" y="583.0221">Q</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="26.0376" x="299.2625" y="583.0221">) for</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="329.2735" y="583.0221">b</text></g><g class="message" data-participant-1="wallet" data-participant-2="cct"><polygon fill="#2FA4E7" points="759.1807,642.1875,769.5974,646.3542,759.1807,650.5208,763.3474,646.3542" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="765.4307" y1="646.3542" y2="646.3542"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="201.2939" x="162.6963" y="636.1145">Bind to CCT CustomTabsService</text></g><g class="message" data-participant-1="wallet" data-participant-2="cct"><polygon fill="#2FA4E7" points="759.1807,681.7383,769.5974,685.9049,759.1807,690.0716,763.3474,685.9049" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="150.1963" x2="765.4307" y1="685.9049" y2="685.9049"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="147.5647" x="162.6963" y="675.6653">Adopt Wallet app origin</text></g><g class="message" data-participant-1="cct" data-participant-2="dal"><polygon fill="#2FA4E7" points="1344.0033,721.2891,1354.42,725.4557,1344.0033,729.6224,1348.17,725.4557" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="782.0974" x2="1350.2533" y1="725.4557" y2="725.4557"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="207.2693" x="794.5974" y="715.2161">Fetch Wallet digital asset link file</text></g><g class="message" data-participant-1="dal" data-participant-2="cct"><polygon fill="#2FA4E7" points="793.5557,735.8724,783.139,740.0391,793.5557,744.2057,789.389,740.0391" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="787.3057" x2="1360.67" y1="740.0391" y2="740.0391"/></g><g class="message" data-participant-1="cct" data-participant-2="cct"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="782.0974" x2="825.8474" y1="794.1406" y2="794.1406"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="825.8474" x2="825.8474" y1="794.1406" y2="807.6823"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="783.139" x2="825.8474" y1="807.6823" y2="807.6823"/><polygon fill="#2FA4E7" points="793.5557,803.5156,783.139,807.6823,793.5557,811.849,789.389,807.6823" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="228.5217" x="794.5974" y="769.3502">Validate native Wallet app signature</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="221.3196" x="794.5974" y="783.901">matches digital asset link assertion</text></g><g class="message" data-participant-1="wallet" data-participant-2="cct"><polygon fill="#2FA4E7" points="759.1807,843.0664,769.5974,847.2331,759.1807,851.3997,763.3474,847.2331" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="150.1963" x2="765.4307" y1="847.2331" y2="847.2331"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="272.052" x="162.6963" y="836.9934">Navigate to wallet-hosted attestation script</text></g><g class="message" data-participant-1="cct" data-participant-2="attest"><polygon fill="#2FA4E7" points="1051.3133,882.6172,1061.7299,886.7839,1051.3133,890.9505,1055.4799,886.7839" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="782.0974" x2="1057.5633" y1="886.7839" y2="886.7839"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="251.5076" x="794.5974" y="876.5442">Load webpage into Chrome Custom Tab</text></g><g class="message" data-participant-1="wallet" data-participant-2="cct"><polygon fill="#2FA4E7" points="759.1807,922.168,769.5974,926.3346,759.1807,930.5013,763.3474,926.3346" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="150.1963" x2="765.4307" y1="926.3346" y2="926.3346"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="300.0488" x="162.6963" y="916.095">Open postMessage channel to attestation script</text></g><g class="message" data-participant-1="wallet" data-participant-2="attest"><polygon fill="#2FA4E7" points="1051.3133,961.7188,1061.7299,965.8854,1051.3133,970.0521,1055.4799,965.8854" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="150.1963" x2="1057.5633" y1="965.8854" y2="965.8854"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="323.4863" x="162.6963" y="955.6458">postMessage("generate-origin-attestation-keypair")</text></g><g class="message" data-participant-1="attest" data-participant-2="attest"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1074.2299" x2="1117.9799" y1="1005.4362" y2="1005.4362"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1117.9799" x2="1117.9799" y1="1005.4362" y2="1018.9779"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1075.2716" x2="1117.9799" y1="1018.9779" y2="1018.9779"/><polygon fill="#2FA4E7" points="1085.6883,1014.8112,1075.2716,1018.9779,1085.6883,1023.1445,1081.5216,1018.9779" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="246.8567" x="1086.7299" y="995.1965">validate postMessage from same origin</text></g><g class="message" data-participant-1="attest" data-participant-2="attest"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1074.2299" x2="1117.9799" y1="1058.5286" y2="1058.5286"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1117.9799" x2="1117.9799" y1="1058.5286" y2="1072.0703"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1075.2716" x2="1117.9799" y1="1072.0703" y2="1072.0703"/><polygon fill="#2FA4E7" points="1085.6883,1067.9036,1075.2716,1072.0703,1085.6883,1076.237,1081.5216,1072.0703" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="162.6953" x="1086.7299" y="1048.289">generate ECDSA keypair (</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="9.8389" x="1249.4253" y="1048.289">Q</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="1259.2641" y="1048.289">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="1267.2109" y="1048.289">d</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="1275.1455" y="1048.289">)</text></g><g class="message" data-participant-1="attest" data-participant-2="attest"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1074.2299" x2="1117.9799" y1="1111.6211" y2="1111.6211"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1117.9799" x2="1117.9799" y1="1111.6211" y2="1125.1628"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1075.2716" x2="1117.9799" y1="1125.1628" y2="1125.1628"/><polygon fill="#2FA4E7" points="1085.6883,1120.9961,1075.2716,1125.1628,1085.6883,1129.3294,1081.5216,1125.1628" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="129.7668" x="1086.7299" y="1101.3814">generate key unique</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="11.4075" x="1220.4702" y="1101.3814">id</text></g><g class="message" data-participant-1="attest" data-participant-2="attest"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1074.2299" x2="1117.9799" y1="1164.7135" y2="1164.7135"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1117.9799" x2="1117.9799" y1="1164.7135" y2="1178.2552"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1075.2716" x2="1117.9799" y1="1178.2552" y2="1178.2552"/><polygon fill="#2FA4E7" points="1085.6883,1174.0885,1075.2716,1178.2552,1085.6883,1182.4219,1081.5216,1178.2552" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="40.2771" x="1086.7299" y="1154.4739">write (</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="11.4075" x="1127.007" y="1154.4739">id</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="1138.4145" y="1154.4739">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="1146.3613" y="1154.4739">d</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="105.957" x="1154.2959" y="1154.4739">) to local storage</text></g><g class="message" data-participant-1="attest" data-participant-2="wallet"><polygon fill="#2FA4E7" points="161.6547,1213.6393,151.238,1217.806,161.6547,1221.9727,157.488,1217.806" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="155.4047" x2="1062.7716" y1="1217.806" y2="1217.806"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="222.3267" x="173.113" y="1207.5663">postMessage("origin-attestation", {</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="11.4075" x="395.4397" y="1207.5663">id</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="406.8471" y="1207.5663">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="9.8389" x="414.7939" y="1207.5663">Q</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="12.8296" x="424.6328" y="1207.5663">})</text></g><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="1257.3568" y2="1257.3568"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="1257.3568" y2="1270.8984"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="151.238" x2="193.9463" y1="1270.8984" y2="1270.8984"/><polygon fill="#2FA4E7" points="161.6547,1266.7318,151.238,1270.8984,161.6547,1275.0651,157.488,1270.8984" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="246.8567" x="162.6963" y="1247.1171">validate postMessage from same origin</text></g><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="1310.4492" y2="1310.4492"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="1310.4492" y2="1323.9909"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="151.238" x2="193.9463" y1="1323.9909" y2="1323.9909"/><polygon fill="#2FA4E7" points="161.6547,1319.8242,151.238,1323.9909,161.6547,1328.1576,157.488,1323.9909" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="40.2771" x="162.6963" y="1300.2096">write (</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="202.9734" y="1300.2096">b</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="210.908" y="1300.2096">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="11.4075" x="218.8548" y="1300.2096">id</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="230.2622" y="1300.2096">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="9.8389" x="238.209" y="1300.2096">Q</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="105.957" x="248.0479" y="1300.2096">) to local storage</text></g><g class="message" data-participant-1="wallet" data-participant-2="cct"><polygon fill="#2FA4E7" points="759.1807,1359.375,769.5974,1363.5417,759.1807,1367.7083,763.3474,1363.5417" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="765.4307" y1="1363.5417" y2="1363.5417"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="106.7383" x="162.6963" y="1353.302">Unbind from CCT</text></g><g class="message" data-participant-1="cct" data-participant-2="attest"><polygon fill="#2FA4E7" points="1056.5216,1398.9258,1066.9383,1403.0924,1056.5216,1407.2591,1060.6883,1403.0924" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="776.889" x2="1062.7716" y1="1403.0924" y2="1403.0924"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="93.2373" x="789.389" y="1392.8528">close webpage</text></g><line style="stroke:#BABDBF;stroke-width:2.0833;" x1="767.514" x2="786.264" y1="1393.7174" y2="1412.4674"/><line style="stroke:#BABDBF;stroke-width:2.0833;" x1="767.514" x2="786.264" y1="1412.4674" y2="1393.7174"/><rect fill="url(#g1idpeqam3785x1)" height="3.125" rx="4.1667" ry="4.1667" style="stroke:url(#g1idpeqam3785x1);stroke-width:1.0417;" width="1517.9311" x="10.4167" y="1444.7428"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="1528.3478" y1="1444.7428" y2="1444.7428"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="1528.3478" y1="1447.8678" y2="1447.8678"/><rect fill="url(#g1idpeqam3785x1)" height="33.3008" rx="4.1667" ry="4.1667" style="stroke:#868E96;stroke-width:2.0833;" width="269.104" x="634.8302" y="1429.1341"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="239.7522" x="646.2886" y="1450.1119">Wallet requests origin attestation</text><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="1504.069" y2="1504.069"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="1504.069" y2="1517.6107"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="151.238" x2="193.9463" y1="1517.6107" y2="1517.6107"/><polygon fill="#2FA4E7" points="161.6547,1513.444,151.238,1517.6107,161.6547,1521.7773,157.488,1517.6107" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="120.7153" x="162.6963" y="1493.8293">generate a random</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="60.6384" x="287.3851" y="1493.8293">challenge</text></g><g class="message" data-participant-1="wallet" data-participant-2="dapp"><polygon fill="#2FA4E7" points="531.8227,1567.5456,542.2394,1571.7122,531.8227,1575.8789,535.9894,1571.7122" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="144.988" x2="538.0727" y1="1571.7122" y2="1571.7122"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="287.0789" x="157.488" y="1546.9218">response {ERROR_ATTEST_ORIGIN_ANDROID,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="11.4075" x="157.488" y="1561.4726">id</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="168.8955" y="1561.4726">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="60.6384" x="176.8422" y="1561.4726">challenge</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="237.4807" y="1561.4726">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="90.9546" x="245.4274" y="1561.4726">attestation_uri</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="7.9529" x="336.382" y="1561.4726">}</text></g><rect fill="url(#g1idpeqam3785x1)" height="3.125" rx="4.1667" ry="4.1667" style="stroke:url(#g1idpeqam3785x1);stroke-width:1.0417;" width="1517.9311" x="10.4167" y="1606.071"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="1528.3478" y1="1606.071" y2="1606.071"/><line style="stroke:#868E96;stroke-width:1.0417;" x1="10.4167" x2="1528.3478" y1="1609.196" y2="1609.196"/><rect fill="url(#g1idpeqam3785x1)" height="33.3008" rx="4.1667" ry="4.1667" style="stroke:#868E96;stroke-width:2.0833;" width="508.6609" x="515.0518" y="1590.4622"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="479.3091" x="526.5101" y="1611.44">Dapp creates origin attestation token and reattempts authorization</text><g class="message" data-participant-1="dapp" data-participant-2="attest"><polygon fill="#2FA4E7" points="1051.3133,1675.7813,1061.7299,1679.9479,1051.3133,1684.1146,1055.4799,1679.9479" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="554.7394" x2="1057.5633" y1="1679.9479" y2="1679.9479"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="197.9675" x="567.2394" y="1655.1575">create invisible iframe and load</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="195.4895" x="567.2394" y="1669.7083">wallet-hosted attestation script</text></g><g class="message" data-participant-1="dapp" data-participant-2="dapp"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="554.7394" x2="598.4894" y1="1734.0495" y2="1734.0495"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="598.4894" x2="598.4894" y1="1734.0495" y2="1747.5911"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="555.781" x2="598.4894" y1="1747.5911" y2="1747.5911"/><polygon fill="#2FA4E7" points="566.1977,1743.4245,555.781,1747.5911,566.1977,1751.7578,562.031,1747.5911" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9224" x="567.2394" y="1709.259">h</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="169.6289" x="579.1351" y="1709.259">= SHA256("attest-origin" ||</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="60.6384" x="567.2394" y="1723.8098">challenge</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.4229" x="631.8512" y="1723.8098">||</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="91.3269" x="644.2474" y="1723.8098">session_secret</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="735.5743" y="1723.8098">)</text></g><g class="message" data-participant-1="dapp" data-participant-2="attest"><polygon fill="#2FA4E7" points="1051.3133,1782.9753,1061.7299,1787.1419,1051.3133,1791.3086,1055.4799,1787.1419" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="554.7394" x2="1057.5633" y1="1787.1419" y2="1787.1419"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="86.6577" x="567.2394" y="1776.9023">postMessage(</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="11.4075" x="653.8971" y="1776.9023">id</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="665.3046" y="1776.9023">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9224" x="673.2513" y="1776.9023">h</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="681.1737" y="1776.9023">)</text></g><g class="message" data-participant-1="attest" data-participant-2="attest"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1074.2299" x2="1117.9799" y1="1826.6927" y2="1826.6927"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1117.9799" x2="1117.9799" y1="1826.6927" y2="1840.2344"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1075.2716" x2="1117.9799" y1="1840.2344" y2="1840.2344"/><polygon fill="#2FA4E7" points="1085.6883,1836.0677,1075.2716,1840.2344,1085.6883,1844.401,1081.5216,1840.2344" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.6477" x="1086.7299" y="1816.453">o</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="151.8127" x="1098.351" y="1816.453">= origin of postMessage</text></g><g class="message" data-participant-1="attest" data-participant-2="attest"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1074.2299" x2="1117.9799" y1="1879.7852" y2="1879.7852"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1117.9799" x2="1117.9799" y1="1879.7852" y2="1893.3268"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1075.2716" x2="1117.9799" y1="1893.3268" y2="1893.3268"/><polygon fill="#2FA4E7" points="1085.6883,1889.1602,1075.2716,1893.3268,1085.6883,1897.4935,1081.5216,1893.3268" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="37.2742" x="1086.7299" y="1869.5455">read (</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="11.4075" x="1124.0041" y="1869.5455">id</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="1135.4116" y="1869.5455">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="1143.3584" y="1869.5455">d</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="122.7722" x="1151.2929" y="1869.5455">) from local storage</text></g><g class="message" data-participant-1="attest" data-participant-2="attest"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1074.2299" x2="1117.9799" y1="1947.4284" y2="1947.4284"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1117.9799" x2="1117.9799" y1="1947.4284" y2="1960.9701"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1075.2716" x2="1117.9799" y1="1960.9701" y2="1960.9701"/><polygon fill="#2FA4E7" points="1085.6883,1956.8034,1075.2716,1960.9701,1085.6883,1965.1367,1081.5216,1960.9701" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="172.2473" x="1086.7299" y="1922.6379">create attestation message</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="12.1765" x="1086.7299" y="1937.1887">m</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="22.3999" x="1102.8798" y="1937.1887">= {</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.6477" x="1125.2797" y="1937.1887">o</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="1132.9274" y="1937.1887">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9224" x="1140.8742" y="1937.1887">h</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="7.9529" x="1148.7966" y="1937.1887">}</text></g><g class="message" data-participant-1="attest" data-participant-2="attest"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1074.2299" x2="1117.9799" y1="2000.5208" y2="2000.5208"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1117.9799" x2="1117.9799" y1="2000.5208" y2="2014.0625"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="1075.2716" x2="1117.9799" y1="2014.0625" y2="2014.0625"/><polygon fill="#2FA4E7" points="1085.6883,2009.8958,1075.2716,2014.0625,1085.6883,2018.2292,1081.5216,2014.0625" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="104.3213" x="1086.7299" y="1990.2812">S = ECDSA-sign(</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="1191.0512" y="1990.2812">d</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="1198.9858" y="1990.2812">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="12.1765" x="1206.9326" y="1990.2812">m</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="1219.1091" y="1990.2812">)</text></g><g class="message" data-participant-1="attest" data-participant-2="dapp"><polygon fill="#2FA4E7" points="566.1977,2049.4466,555.781,2053.6133,566.1977,2057.7799,562.031,2053.6133" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="559.9477" x2="1062.7716" y1="2053.6133" y2="2053.6133"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="86.6577" x="577.656" y="2043.3736">postMessage(</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="12.1765" x="664.3138" y="2043.3736">m</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="676.4903" y="2043.3736">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="684.4371" y="2043.3736">S</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="692.3716" y="2043.3736">)</text></g><g class="message" data-participant-1="dapp" data-participant-2="dapp"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="554.7394" x2="598.4894" y1="2107.7148" y2="2107.7148"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="598.4894" x2="598.4894" y1="2107.7148" y2="2121.2565"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="555.781" x2="598.4894" y1="2121.2565" y2="2121.2565"/><polygon fill="#2FA4E7" points="566.1977,2117.0898,555.781,2121.2565,566.1977,2125.4232,562.031,2121.2565" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="169.281" x="567.2394" y="2082.9244">validate postMessage from</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="114.9353" x="567.2394" y="2097.4752">attest script origin</text></g><g class="message" data-participant-1="dapp" data-participant-2="attest"><polygon fill="#2FA4E7" points="1056.5216,2156.6406,1066.9383,2160.8073,1056.5216,2164.974,1060.6883,2160.8073" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="554.7394" x2="1062.7716" y1="2160.8073" y2="2160.8073"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="147.0581" x="567.2394" y="2150.5676">destroy invisible iframe</text></g><g class="message" data-participant-1="dapp" data-participant-2="wallet"><polygon fill="#2FA4E7" points="161.6547,2196.1914,151.238,2200.3581,161.6547,2204.5247,157.488,2200.3581" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="155.4047" x2="543.281" y1="2200.3581" y2="2200.3581"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="86.7371" x="173.113" y="2190.1184">authorize {...,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="12.1765" x="263.8234" y="2190.1184">m</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="276" y="2190.1184">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="283.9467" y="2190.1184">S</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="7.9529" x="291.8813" y="2190.1184">}</text></g><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="2239.9089" y2="2239.9089"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="2239.9089" y2="2253.4505"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="151.238" x2="193.9463" y1="2253.4505" y2="2253.4505"/><polygon fill="#2FA4E7" points="161.6547,2249.2839,151.238,2253.4505,161.6547,2257.6172,157.488,2253.4505" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="107.373" x="162.6963" y="2229.6692">read stored key (</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="11.4075" x="270.0694" y="2229.6692">id</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="281.4768" y="2229.6692">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="9.8389" x="289.4236" y="2229.6692">Q</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="26.0376" x="299.2625" y="2229.6692">) for</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="329.2735" y="2229.6692">b</text></g><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="2307.5521" y2="2307.5521"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="2307.5521" y2="2321.0938"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="151.238" x2="193.9463" y1="2321.0938" y2="2321.0938"/><polygon fill="#2FA4E7" points="161.6547,2316.9271,151.238,2321.0938,161.6547,2325.2604,157.488,2321.0938" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="113.3179" x="162.6963" y="2282.7616">validate signature</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="87.6221" x="162.6963" y="2297.3124">ECDSA-verify(</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="9.8389" x="250.3184" y="2297.3124">Q</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="260.1573" y="2297.3124">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="12.1765" x="268.104" y="2297.3124">m</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="280.2806" y="2297.3124">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9346" x="288.2273" y="2297.3124">S</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="296.1619" y="2297.3124">)</text></g><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="2375.1953" y2="2375.1953"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="2375.1953" y2="2388.737"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="151.238" x2="193.9463" y1="2388.737" y2="2388.737"/><polygon fill="#2FA4E7" points="161.6547,2384.5703,151.238,2388.737,161.6547,2392.9036,157.488,2388.737" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="79.5471" x="162.6963" y="2350.4049">validate that</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="12.1765" x="246.2168" y="2350.4049">m</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="52.9114" x="262.3667" y="2350.4049">contains</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9224" x="319.2515" y="2350.4049">h</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.9224" x="162.6963" y="2364.9556">h</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="169.6289" x="174.5921" y="2364.9556">= SHA256("attest-origin" ||</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="60.6384" x="348.1944" y="2364.9556">challenge</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.4229" x="412.8062" y="2364.9556">||</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="91.3269" x="425.2024" y="2364.9556">session_secret</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="4.8767" x="516.5293" y="2364.9556">)</text></g><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="2428.2878" y2="2428.2878"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="2428.2878" y2="2441.8294"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="151.238" x2="193.9463" y1="2441.8294" y2="2441.8294"/><polygon fill="#2FA4E7" points="161.6547,2437.6628,151.238,2441.8294,161.6547,2445.9961,157.488,2441.8294" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="210.4492" x="162.6963" y="2418.0481">validate identity is valid for origin</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="7.6477" x="377.1189" y="2418.0481">o</text></g><g class="message" data-participant-1="wallet" data-participant-2="wallet"><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="150.1963" x2="193.9463" y1="2481.3802" y2="2481.3802"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="193.9463" x2="193.9463" y1="2481.3802" y2="2494.9219"/><line style="stroke:#2FA4E7;stroke-width:3.125;" x1="151.238" x2="193.9463" y1="2494.9219" y2="2494.9219"/><polygon fill="#2FA4E7" points="161.6547,2490.7552,151.238,2494.9219,161.6547,2499.0885,157.488,2494.9219" style="stroke:#2FA4E7;stroke-width:1.0417;"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="111.7065" x="162.6963" y="2471.1405">create auth token</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="12.561" x="278.3763" y="2471.1405">at</text></g><g class="message" data-participant-1="wallet" data-participant-2="dapp"><polygon fill="#2FA4E7" points="531.8227,2530.306,542.2394,2534.4727,531.8227,2538.6393,535.9894,2534.4727" style="stroke:#2FA4E7;stroke-width:1.0417;"/><line style="stroke:#2FA4E7;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="144.988" x2="538.0727" y1="2534.4727" y2="2534.4727"/><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="68.9758" x="157.488" y="2524.233">response {</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="12.561" x="226.4638" y="2524.233">at</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="3.9734" x="239.0249" y="2524.233">,</text><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="16.5344" x="246.9716" y="2524.233">uri</text><text fill="#343A40" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="7.9529" x="263.5061" y="2524.233">}</text></g><!--SRC=[hLPDRzj64BtpLqoLYmnRBb2WFGYH0KLsKWEkZKfEsuC0OqMEn8N8NNPtASLr_Dyx-y4lYROJj3u42hdpPjxRUJFymQIO8yIeoWoPYFIMYu8fbiEAnTkDagL8PZAJ2jvzT7zHbF84OIsbMSalKKJ_mE2M6Rv3c8f4IPu0Aue1lBlXczHyKeWY8aJ3OrumOM3FiWmDC0s3FyDFEXwXIC02EhmAQ9OgcME5zI4hiGELKAG7mfNxpw3pEevz6ey2ir8RcSCzMos5HhNZCNRFCsDGjoiRfL8RJ62F528Ltt0H3X5VAK37YXTcS51JreDmIR66PKinrPeOtt2nRIX7ambSEYg4dHT6Wv70IfDIodyGzjoaK0gVcB18Vc6uUOJ998fOJCepWuv-v0GPNLGQdvx262YZZBazCjnn1ZSofWe_pw_XMXW2EeaIh45yN2Ga_POxLE71cLTw30j3J3MmjQ5t2zJQgd15SgmohjCShUWoBoW4TMyn3Qkdy_FpPqVz0oSTGYiGyPMIUsrJMzgiA_WM7ml6bMCUO9i4OtZFBrRlV-GNC3cYMS4kgRlZBTjWa77DKKKiCrK1ATqT0seKHKeN9V6ARLRgTrN3Hq1_FUaLigGAjJ532k29ZJYpiR_RNoTT9CmqLgaJYHf8Ugg1lFHTHVprduheqh6kEJqT-skX-vZDxeDro3bwuOtJYGb1r6g9B6ebxUrxpxZ3zWGTjFPmdV0HJPpMrBqzo3ZM7Hcv0zOyyraKcb9rC7ooFrZ64zkqmW-VLbhDD_ImLBWKEQCqf6jF1ljJsRRg9tFBTdnZyKc3VSVCnoEWgOx2mnXnB6yaS-EZS1qdh9o7mwW_-rs10WhAznkvp0R7AHC2CpSQ-lEtC489upR2SB11WOeOZVorZ5eue-2imOc32l5jf5qbTxkeDN41pOXFwwPxWglCS3MxN4nh6m-hXdIjwPhqv4q8szIbu7-N27LhlnIqLzpElQu5V1uhPEQ6X3KBaUbWj6tTqV1Oki4PFFLuxFdafJ7nxKhs13UCLdM-OtltSkjQV0oVnSfQt6Kca_Vry1ZYJDA42XtiZhJMXJyLdcgZvAC5i7lD3VRWI8LqLvhMHiy6VM6GrvVDG36HK874ZHn0hyK6tOstkjqlcf4RVhgGjDpXwMe-lvi_JE_lhnRt3tVpwq_Njm_JsylvtVNbsL9qHUi0koUj4XzAnTrzDciwfXbBx_lu6BabtrB9TWvNsxnQUWtbQZMsHuL7fI6nuvglClgrLhOVB5X6OsGftfn25MpOraGa3UjmyUlqfvz_6GvyK1W00_ZwrMdH4O0UsaZjj_k3HYhCU6i6eL-OBrrHKn_IOqfwAKDPGK6vRWFrnRYjrkzZrx_TRky12EgsHSjzEgT07WfwgefhE3ptmIteh9jb8xjhXbKrBYhlCc_kuq2il8vOjEMjZxyu9vRXMp1SUpKn3ffgN7loiAMYOmk__QtMK6jAVex-dw-WruPaQvTxmUcpbAyVkwlZIChN44tAJ1r4twl2C2vqVT-k7zxq3No7RLuhflwOvze_TCe4NrJDs8TGDJHTKfWwRcvzosoi3ph5wldsBm00]--></g></svg>